---
description: 
globs: 
alwaysApply: true
---
Please follow this file structure when making new files or changing them, specifically for the app itself.

lib/
│
├── main.dart                         # App entry point
├── app/
│   ├── app.dart                      # Root widget (MaterialApp)
│   ├── config/                       # Global constants, themes, routing, environment setup
│   ├── theme/                        # Colours, typography (from your Figma)
│   ├── router/                       # GoRouter or AutoRoute setup
│   └── localization/                 # English localization files (future multi-lang ready)
│
├── core/                             # Core utilities used across the app
|   ├── di/                           # DI graph entry
|   │   ├── main_providers.dart       # Registers all top-level Riverpod providers
│   │   └── di_graph.dart             # explicit DI graph visualizer/initializer
│   ├── constants/                    # App-wide constants (e.g., colors, spacing)
│   ├── errors/                       # Custom exceptions, failure classes
│   ├── utils/                        # Formatters, validators, etc.
│   ├── services/                     # Global services (APIs, Auth, OCR, AI, Encryption, Migration, Subscription, Sync Manager, Background Task Manager, Notification, Networking, etc.)
│   ├── monitoring/                   # Logs, crash reporting, diagnostics
│   └── mixins/                       # Generic Flutter mixins (animation, refreshable, etc.)
│
├── data/                             # Global data layer
│   ├── local/                        # Drift setup, AppDatabase, DAOs for shared data
│   │   ├── app_database.dart
│   │   ├── daos/
│   │   └── models/                   # DB models (Drift tables)
│   ├── remote/                       # Supabase or REST services
│   ├── repositories/                 # Implementations of domain repositories
│   └── mappers/                      # Bridges DB/API ↔ Domain entities
│
├── domain/                           # All domain logic
│   ├── entities/                     # Pure models used across the app (not DB)
│   ├── repositories/                 # Abstract repository interfaces for each entity group
│   └── usecases/                     # Feature-specific use cases (app layer orchestration)
│
├── features/                         # Feature-based folders (main app logic)
│   ├── auth/                         # Authentication
│   │   ├── logic/                    # State (BLoC, Riverpod)
│   │   └── ui/                       # Login, signup, forgot password screens
│
│   ├── file_upload/                  # File picker, preview, upload, OCR
│   │   ├── logic/                    # State (upload status, OCR result)
│   │   └── ui/                       # UI to select, upload, view files
│
│   ├── biomarkers/                   # Biomarker data and organ UI
│   │   ├── logic/                    # State for biomarker lists, updates
│   │   └── ui/                       # Organ/part view, biomarker cards
│
│   ├── timeline/                     # Timeline view and health progression
│   │   ├── logic/
│   │   └── ui/
│
│   ├── sharing/                      # Share with doctors, parents, etc.
│   │   ├── logic/
│   │   └── ui/
│
│   ├── doctor_notes/                 # Visit notes, prescriptions
│   │   ├── logic/
│   │   └── ui/
│
│   ├── labs/                         # Lab API integration & kit orders
│   │   ├── logic/
│   │   └── ui/
│
│   ├── kick_counter/                 # Kick counter
│   │   ├── logic/
│   │   └── ui/
│
│   ├── ai_chat/                      # AI assistant
│   │   ├── logic/
│   │   └── ui/
│
├── shared/
│   ├── widgets/                      # Global reusable widgets (buttons, cards, modals)
│   ├── providers/                    # Global Riverpod providers (theme, auth, etc.)
│   └── extensions/                   # String, DateTime extensions

assets/
├── images/
├── icons/
├── fonts/
├── audio/
└── lottie/

test/
├── core/
│    ├── utils/
│    ├── services/
│    └── di/
│
├── data/
│    ├── repositories/
│    ├── datasources/
│    └── models/
│
├── domain/
│    ├── entities/
│    ├── usecases/
│    └── mappers/
│
├── features/
│
├── harness/
│    ├── test_harness.dart          # Core harness entry — initializes the test environment.
│    ├── mock_dependencies.dart     # Registers mock repositories/services.
│    ├── test_app_wrapper.dart      # Wraps widgets in ProviderScope, MaterialApp, etc.
│    └── fixtures.dart              # Loads JSON/sample test data.
│
├── integration/
│    ├── user_flows/
│    └── network/
│
├── mocks/
│    ├── fake_data/
│    ├── stubs/
│    └── mock_repositories.dart
│
└── test_config.dart
